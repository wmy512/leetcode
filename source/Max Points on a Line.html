<html>
<head>
  <title>Max Points on a Line</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/270387 (zh-CN); Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="4388"/>
<h1>Max Points on a Line</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div align="left"><div style="box-sizing: border-box; padding-bottom: 10px; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238); color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 20px; text-align: start; background-color: rgb(255, 255, 255);"><h3 style="box-sizing: border-box; font-weight: 500; line-height: 1.1; margin-top: 20px; margin-bottom: 10px; font-size: 24px; display: inline;">Max Points on a Line</h3>
 <span style="box-sizing: border-box; color: rgb(58, 135, 173); margin-left: 30px; font-size: 13px; vertical-align: text-bottom;">Total Accepted: <strong style="box-sizing: border-box;">158</strong></span> <span style="box-sizing: border-box; color: rgb(58, 135, 173); margin-left: 15px; font-size: 13px; vertical-align: text-bottom;">Total Submissions: <strong style="box-sizing: border-box;">2198</strong></span><a href="http://oj.leetcode.com/problems/max-points-on-a-line/submissions/" style="box-sizing: border-box; color: rgb(51, 51, 51); text-decoration: none; display: inline-block; padding: 6px 12px; margin-bottom: 0px; line-height: 1.428571429; text-align: center; white-space: nowrap; vertical-align: middle; cursor: pointer; border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; float: right !important;">My Submissions</a></div><div style="box-sizing: border-box; margin-right: -15px; margin-left: -15px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 20px; text-align: start; background-color: rgb(255, 255, 255);"><div style="box-sizing: border-box; position: relative; min-height: 1px; padding-right: 15px; padding-left: 15px; width: 1170px;"><div style="box-sizing: border-box; margin-left: 20px; line-height: 30px;"><p style="box-sizing: border-box; margin: 0px 0px 10px;"></p><p style="box-sizing: border-box; margin: 0px 0px 10px;">Given <i style="box-sizing: border-box;">n</i> points on a 2D plane, find the maximum number of points that lie on the same straight line.</p></div></div></div></div><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt"><br></span></font></div><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt"><br></span></font></div><div align="left"><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">#include</span></font> <font color="#A31515" face="Consolas" size="1"><span style="font-size:9pt">&lt;iostream&gt;</span></font></div><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">using</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">namespace</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">std;</span></font></div><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">#include</span></font> <font color="#A31515" face="Consolas" size="1"><span style="font-size:9pt">&lt;string&gt;</span></font></div><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">#include</span></font> <font color="#A31515" face="Consolas" size="1"><span style="font-size:9pt">&lt;vector&gt;</span></font></div><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">#include</span></font> <font color="#A31515" face="Consolas" size="1"><span style="font-size:9pt">&lt;algorithm&gt;</span></font></div><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">#include</span></font> <font color="#A31515" face="Consolas" size="1"><span style="font-size:9pt">&lt;stack&gt;</span></font></div><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">#include</span></font> <font color="#A31515" face="Consolas" size="1"><span style="font-size:9pt">&lt;unordered_map&gt;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt"><br></span></font></div><div align="left"><font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">// Definition for a point.</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt"> </span></font><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">struct</span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">Point</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">x;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">y;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">     Point() : x(0), y(0) {}</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">     Point(</span></font><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">a</span></font><font face="Consolas" size="1"><span style="font-size:9pt">,</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">b</span></font><font face="Consolas" size="1"><span style="font-size:9pt">) : x(</span></font><font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">a</span></font><font face="Consolas" size="1"><span style="font-size:9pt">), y(</span></font><font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">b</span></font><font face="Consolas" size="1"><span style="font-size:9pt">) {}</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt"> };</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt"> </span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt"><br></span></font></div><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">class</span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">Solution</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">static</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">bool</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">PointXCompare(</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">const</span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">Point</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">&amp;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">lhs</span></font><font face="Consolas" size="1"><span style="font-size:9pt">,</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">const</span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">Point</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">&amp;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">rhs</span></font><font face="Consolas" size="1"><span style="font-size:9pt">) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">return</span></font><font face="Consolas" size="1"><span style="font-size:9pt"> </span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">lhs</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.x &lt;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">rhs</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.x;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">static</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">bool</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">PointYCompare(</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">const</span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">Point</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">&amp;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">lhs</span></font><font face="Consolas" size="1"><span style="font-size:9pt">,</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">const</span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">Point</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">&amp;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">rhs</span></font><font face="Consolas" size="1"><span style="font-size:9pt">) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">return</span></font><font face="Consolas" size="1"><span style="font-size:9pt"> </span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">lhs</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.y &lt;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">rhs</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.y;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt"><br></span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">static</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">bool</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">FloatCompare(</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">float</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">a</span></font><font face="Consolas" size="1"><span style="font-size:9pt">,</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">float</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">b</span></font><font face="Consolas" size="1"><span style="font-size:9pt">) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">const</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">float</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">epsilon = 0.000001;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">return</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">a</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">-</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">b</span></font><font face="Consolas" size="1"><span style="font-size:9pt">) &lt; epsilon &amp;&amp; (</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">b</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">-</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">a</span></font><font face="Consolas" size="1"><span style="font-size:9pt">) &gt; -epsilon;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">public</span></font><font face="Consolas" size="1"><span style="font-size:9pt">:</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">maxPoints2(</span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">vector</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&lt;</span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">Point</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&gt; &amp;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">// IMPORTANT: Please reset any member data you declared, as</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">// the same Solution instance will be reused for each test case.</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">//O(n2)</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">if</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.size() &lt;= 2) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">return</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.size();</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">const</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">float</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">float_max = std::</span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">numeric_limits</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&lt;</span></font><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">float</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">&gt;::infinity();</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">max_count = 2;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">//以每个点为中心，计算其他值到它的slope，然后使用hash计数即可</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">for</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">i = 0; i &lt;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.size() - 1; i++) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">// 优化1 当剩余点小于max_point时，退出</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">if</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.size() - i &lt; max_count) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">break</span></font><font face="Consolas" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">// 有重复点。。</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">repeat_point = 0;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">unordered_map</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&lt;</span></font><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">double</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">,</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">&gt; line_nums;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">float</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">slope;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">for</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">j = i + 1; j &lt;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.size(); j++) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">if</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[j].x ==</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[i].x &amp;&amp;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[j].y ==</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[i].y) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                    repeat_point++;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                   </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">continue</span></font><font face="Consolas" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">if</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[j].x ==</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[i].x) {</span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">//竖直</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                    slope = float_max;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">else</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                    slope = (</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">float</span></font><font face="Consolas" size="1"><span style="font-size:9pt">)(</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[j].y -</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[i].y) / (</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[j].x -</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">[i].x);</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                line_nums[slope]++;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">max_slope_num = 0;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">for</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(</span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">unordered_map</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&lt;</span></font><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">double</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">,</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">&gt;::</span></font><font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">iterator</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">iter = line_nums.begin(); iter != line_nums.end(); ++iter) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                max_slope_num = max(max_slope_num, iter-&gt;second);</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">            max_count = max(max_count, repeat_point + max_slope_num + 1);</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">return</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">max_count;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">maxPoints(</span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">vector</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&lt;</span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">Point</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&gt; &amp;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">// IMPORTANT: Please reset any member data you declared, as</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">// the same Solution instance will be reused for each test case.</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">//O(n2log(n))</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">// bug 1: 没有考虑重复点</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">if</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.size() &lt;= 2) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">return</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.size();</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">max_count = 2;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">const</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">float</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">float_max = 3.402823466e+38F ;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt"><br></span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">// 以每个点作为中心，计算其他值到它的slope，并排序，这样如果一样的斜率存在那么一定共线</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">for</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">i = 0; i &lt;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.size() - 1; i++) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">// 优化1 当剩余点小于max_point时，退出</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">if</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.size() - i &lt; max_count) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">break</span></font><font face="Consolas" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">// 有重复点。。</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">repeat_point = 0;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt"><br></span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">vector</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&lt;</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">float</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&gt; slopes(</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.size() - i - 1);</span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">//只处理剩余点即可，前面的都已经处理过了</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">index = 0;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">//开始计算斜率并排序</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">for</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">j = i + 1; j &lt;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.size(); j++) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">if</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[j].x ==</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[i].x &amp;&amp;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[j].y ==</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[i].y) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                    repeat_point++;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                   </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">continue</span></font><font face="Consolas" size="1"><span style="font-size:9pt">;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">if</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(j != i) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                   </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">if</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[j].x ==</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[i].x) {</span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">//竖直</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                        slopes[index++] = float_max;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                    }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                   </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">else</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                        slopes[index++] = (</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">float</span></font><font face="Consolas" size="1"><span style="font-size:9pt">)(</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[j].y -</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[i].y) / (</span></font><font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[j].x -</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">points</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">[i].x);</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                    }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">            sort(slopes.begin(), slopes.begin() + index);</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">          </span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">//找到共线的个数</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">cur = 0;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">float</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">first = slopes[0];</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">count = 1;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">while</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(++cur &lt; index) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">if</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(FloatCompare(slopes[cur], first)) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                    count++;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">else</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                    count = 1;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                    first = slopes[cur];</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                max_count = max(max_count, count + 1 + repeat_point);</span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">//数量等于斜率的个数加1个数</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">//最后需要更新，因为有一部分点没有考虑</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">if</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(index == 0) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                max_count = max(max_count, 1 + repeat_point);</span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">//没有线段，数量等于自己加上重复点数</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">else</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                max_count = max(max_count, count + 1 + repeat_point);</span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">//数量等于斜率的个数加重复点个数</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">return</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">max_count;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">};</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt"><br></span></font></div><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">main() {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">   </span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">Solution</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">so;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">  </span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">   </span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">Point</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">p0(1, 1), p1(2, 1), p2(1, 1), p3(2, 1), p4(3, 3), p5(3, 3);</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">  </span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">   </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">//重点考虑 (0, 0), (1, 0), (0, 0);</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">   </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">//        (1, 1), (1, 1), (1, 1);</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">   </span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">vector</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&lt;</span></font><font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">Point</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&gt; points;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    points.push_back(p0);</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    points.push_back(p1);</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    points.push_back(p2);</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    points.push_back(p3);</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    points.push_back(p4);</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    points.push_back(p5);</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    cout &lt;&lt; so.maxPoints(points) &lt;&lt; endl;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    cout &lt;&lt; so.maxPoints2(points) &lt;&lt; endl;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">return</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">0;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">}</span></font></div></div><div align="left">  </div></div>
</div></body></html> 