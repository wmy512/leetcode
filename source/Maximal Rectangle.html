<html>
<head>
  <title>Maximal Rectangle</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/270387 (zh-CN); Windows/6.1.7601 Service Pack 1;"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="4102"/>
<h1>Maximal Rectangle</h1>

<div>
<div style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;"><div style="box-sizing: border-box; margin-right: -15px; margin-left: -15px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);"><div style="box-sizing: border-box; position: relative; min-height: 1px; padding-right: 15px; padding-left: 15px; width: 1170px;"><div style="box-sizing: border-box; padding-bottom: 10px; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: rgb(238, 238, 238);"><h3 style="box-sizing: border-box; font-weight: 500; line-height: 1.1; margin-top: 20px; margin-bottom: 10px; font-size: 24px; display: inline;">Maximal Rectangle</h3>
 <span style="box-sizing: border-box; color: rgb(58, 135, 173); margin-left: 30px; font-size: 13px; vertical-align: text-bottom;">Total Accepted: <strong style="box-sizing: border-box;">863</strong></span> <span style="box-sizing: border-box; color: rgb(58, 135, 173); margin-left: 15px; font-size: 13px; vertical-align: text-bottom;">Total Submissions: <strong style="box-sizing: border-box;">4607</strong></span><a href="http://oj.leetcode.com/problems/maximal-rectangle/submissions/" style="box-sizing: border-box; color: rgb(51, 51, 51); text-decoration: none; display: inline-block; padding: 6px 12px; margin-bottom: 0px; line-height: 1.428571429; text-align: center; white-space: nowrap; vertical-align: middle; cursor: pointer; border: 1px solid rgb(204, 204, 204); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; float: right !important;">My Submissions</a></div><div style="box-sizing: border-box; margin-right: -15px; margin-left: -15px;"><div style="box-sizing: border-box; position: relative; min-height: 1px; padding-right: 15px; padding-left: 15px; width: 1170px;"><div style="box-sizing: border-box; margin-left: 20px; line-height: 30px;"><p style="box-sizing: border-box; margin: 0px 0px 10px;"></p><p style="box-sizing: border-box; margin: 0px 0px 10px;">Given a 2D binary matrix filled with 0's and 1's, find the largest rectangle containing all ones and return its area.</p><p style="box-sizing: border-box; margin: 0px 0px 10px;"></p></div></div></div></div></div><p style="box-sizing: border-box; margin: 12px 0px 10px; color: rgb(51, 51, 51); font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif; font-size: 14px; line-height: 20px; background-color: rgb(255, 255, 255);"><a href="http://oj.leetcode.com/discuss/oj/maximal-rectangle" style="box-sizing: border-box; color: rgb(255, 255, 255); text-decoration: none; display: inline-block; padding: 6px 20px; margin-bottom: 0px; font-size: 16px; line-height: 1.428571429; text-align: center; white-space: nowrap; vertical-align: middle; cursor: pointer; border: 1px solid rgb(76, 174, 76); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; background-color: rgb(92, 184, 92);">Discuss</a></p><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">#include</span></font> <font color="#A31515" face="Consolas" size="1"><span style="font-size:9pt">&lt;iostream&gt;</span></font></div><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">using</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">namespace</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">std;</span></font></div><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">#include</span></font> <font color="#A31515" face="Consolas" size="1"><span style="font-size:9pt">&lt;vector&gt;</span></font></div><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">#include</span></font> <font color="#A31515" face="Consolas" size="1"><span style="font-size:9pt">&lt;stack&gt;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt"><br></span></font></div><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">class</span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">Solution</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">public</span></font><font face="Consolas" size="1"><span style="font-size:9pt">:</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">maximalRectangle(</span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">vector</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&lt;</span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">vector</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&lt;</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">char</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&gt; &gt; &amp;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">matrix</span></font><font face="Consolas" size="1"><span style="font-size:9pt">) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">// IMPORTANT: Please reset any member data you declared, as</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">// the same Solution instance will be reused for each test case.</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">// 以每行为x坐标，然后每列相连的1的个数构成高度，就成了最大的柱状图面积（可以用O(n)的解法）</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">// 求height，使用动态规划预先求好所有的高度</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">if</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">matrix</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.size() == 0) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">return</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">0;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">vector</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&lt;</span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">vector</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&lt;</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&gt; &gt; height(</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">matrix</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.size(),</span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">vector</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&lt;</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&gt;(</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">matrix</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[0].size()));</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">for</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">i = 0; i &lt;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">matrix</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.size(); i++) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">for</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">j = 0; j &lt;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">matrix</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[i].size(); j++) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">if</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(i == 0) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                    height[i][j] =</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">matrix</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[i][j] ==</span></font> <font color="#A31515" face="Consolas" size="1"><span style="font-size:9pt">'1'</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">? 1 : 0;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">else</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                    height[i][j] =</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">matrix</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[i][j] ==</span></font> <font color="#A31515" face="Consolas" size="1"><span style="font-size:9pt">'1'</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">? height[i - 1][j]  + 1 : 0;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">max_area = 0;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">for</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">i = 0; i &lt;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">matrix</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.size(); i++) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">            max_area = max(max_area, LargestArea(height[i]));</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">return</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">max_area;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt"><br></span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">LargestArea(</span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">vector</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&lt;</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&gt; &amp;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">height</span></font><font face="Consolas" size="1"><span style="font-size:9pt">) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">stack</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&lt;</span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&gt; under_area;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">i = 0;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">max_area = 0;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">height</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.push_back(0);</span></font> <font color="#008000" face="Consolas" size="1"><span style="font-size:9pt">//最后都要弹出</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">while</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(i &lt;</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">height</span></font><font face="Consolas" size="1"><span style="font-size:9pt">.size()) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">if</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">(under_area.empty() ||</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">height</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[under_area.top()] &lt;=</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">height</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[i]) {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                under_area.push(i++);</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">           </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">else</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">{</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">               </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">top = under_area.top();</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                under_area.pop();</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">                max_area = max(max_area,</span></font> <font color="#808080" face="Consolas" size="1"><span style="font-size:9pt">height</span></font><font face="Consolas" size="1"><span style="font-size:9pt">[top] * (under_area.empty() ? i : i - under_area.top() - 1));</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">            }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">        }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">       </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">return</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">max_area;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    }</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">};</span></font></div><div align="left"><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">int</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">main() {</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">   </span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">Solution</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">so;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">   </span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">vector</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&lt;</span></font><font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">vector</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&lt;</span></font><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">char</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&gt; &gt; vi;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">   </span></font> <font color="#2B91AF" face="Consolas" size="1"><span style="font-size:9pt">vector</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&lt;</span></font><font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">char</span></font><font face="Consolas" size="1"><span style="font-size:9pt">&gt; tmp;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    tmp.push_back(</span></font><font color="#A31515" face="Consolas" size="1"><span style="font-size:9pt">'0'</span></font><font face="Consolas" size="1"><span style="font-size:9pt">);</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    tmp.push_back(</span></font><font color="#A31515" face="Consolas" size="1"><span style="font-size:9pt">'1'</span></font><font face="Consolas" size="1"><span style="font-size:9pt">);</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    vi.push_back(tmp);</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">    cout &lt;&lt; so.maximalRectangle(vi) &lt;&lt; endl;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">   </span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt"><br></span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">   </span></font> <font color="#0000FF" face="Consolas" size="1"><span style="font-size:9pt">return</span></font> <font face="Consolas" size="1"><span style="font-size:9pt">0;</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt">}</span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt"><br></span></font></div><div align="left"><font face="Consolas" size="1"><span style="font-size:9pt"><br></span></font></div><div align="left"><h1 style="font-size: 14.7px; margin-bottom: 10px; color: rgb(75, 75, 75); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; text-align: start;"><a href="http://www.cnblogs.com/lichen782/p/leetcode_maximal_rectangle.html" style="text-decoration: none; color: rgb(26, 139, 200);">LeetCode 笔记系列 18 <span style="line-height: 22px; background-color: rgb(173, 216, 230);">Maximal</span> <span style="line-height: 22px; background-color: rgb(173, 216, 230);">Rectangle</span> [学以致用]</a></h1><div style="color: rgb(75, 75, 75); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 13px; line-height: 19px; text-align: start;"><p style="margin: 10px auto !important;">题目： Given a 2D binary matrix filled with 0's and 1's, find the largest <span style="background-color: rgb(173, 216, 230);">rectangle</span> containing all ones and return its area.</p><p style="margin: 10px auto !important;"><img src="Maximal Rectangle_files/Image.png" type="image/png" height="207" style="cursor: default;" width="207"/></p><p style="margin: 10px auto !important;">leetcode的题目真是越来越经典了。比如这个题目，就是一道男默女泪的题。</p><p style="margin: 10px auto !important;">一般人拿到这个题目，除非做过类似的，很难一眼找出一个方法来，更别说找一个比较优化的方法了。</p><p style="margin: 10px auto !important;">首先一个难点就是，你怎么判断某个区域就是一个矩形呢？</p><p style="margin: 10px auto !important;">其次，以何种方式来遍历这个2D的matrix呢？</p><p style="margin: 10px auto !important;">一般来说，对这种“棋盘式”的题目，像什么Queen啦，象棋啦，数独啦，如果没有比较明显的遍历方式，可以采用一行一行地遍历。（好像废话哦。。。）</p><p style="margin: 10px auto !important;">然后，当遍历到(i, j)的时候，该做什么样的事情呢？想想，嗯，那我可不可以简单看看，以(i,j)为矩形左上角，能不能形成一个矩形，能不能形成多个矩形？那形成的矩形中，我们能不能找一个最大的呢？（有同学问，为毛你要以这个点为左上角，不为左下角，或者其他脚哩？因为我们打算从左到右，从上到下一行一行遍历嘛，这样就不会漏掉，说不定还能做一些优化）</p><p style="margin: 10px auto !important;">首先，如果(i, j)是0，那肯定没法是矩形了。</p><p style="margin: 10px auto !important;">如果是1，那么我们怎么找以它为左上角的矩形呢？呼唤画面感！</p><p style="margin: 10px auto !important;"><img src="Maximal Rectangle_files/Image [1].png" type="image/png" height="275" style="cursor: default;" width="424"/></p><p style="margin: 10px auto !important;">。。。你TM在逗我？==b</p><p style="margin: 10px auto !important;">图中圈圈表示左上角的1，那么矩形的可能性是。。。太多啦，怎么数嘛！</p><p style="margin: 10px auto !important;">我们可以试探地从左上角的1所在的列开始，往下数数，然后呢，比如在第一行，例如是蓝色的那个矩形，我们看看在列上，它延伸了多远，这个面积是可以算出来的。</p><p style="margin: 10px auto !important;">然后继续，第二行，例如是那个红色的矩形，再看它延伸到多远，哦，我们知道，比第一行近一些，我们也可以用当前离第一行的行数，乘以延伸的距离，得到当前行表示的矩形面积。</p><p style="margin: 10px auto !important;">但是到了第一个虚线的地方，它远远超过了上面的其他所有行延伸的距离了，注意它的上方都是空心的哦，所以，我们遇到这种情况，计算当前行和左上角1围成的面积的时候，<span style="line-height: 36px; font-size: 18pt;"><strong>只能取所有前面最小的延伸距离乘以当前离第一行的行数</strong></span>。其实，这对所有情况都是这样的，是吧？于是，我们不是就有方法遍历这些所有的矩形了嘛。</p><p style="margin: 10px auto !important;">代码如下：</p><div style="background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; font-family: 'Courier New' !important; font-size: 12px !important;"><img src="Maximal Rectangle_files/Image.gif" type="image/gif" style="cursor: default;"/><div><div style="margin-top: 5px;"><span style="line-height: 1.5 !important; padding-right: 5px;"><a style="color: rgb(26, 139, 200); border: none !important;" title="复制代码"><img src="Maximal Rectangle_files/Image [1].gif" type="image/gif" alt="复制代码" style="cursor: default;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);"> 1</span>     <span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">/**</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);"> 2</span> <span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">     * 以给出的坐标作为左上角，计算其中的最大矩形面积
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);"> 3</span> <span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">     * </span><span style="line-height: 1.5 !important; color: rgb(128, 128, 128);">@param</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 0);"> matrix
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);"> 4</span> <span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">     * </span><span style="line-height: 1.5 !important; color: rgb(128, 128, 128);">@param</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 0);"> row 给出坐标的行
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);"> 5</span> <span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">     * </span><span style="line-height: 1.5 !important; color: rgb(128, 128, 128);">@param</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 0);"> col 给出坐标的列
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);"> 6</span> <span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">     * </span><span style="line-height: 1.5 !important; color: rgb(128, 128, 128);">@return</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 0);"> 返回最大矩形的面积
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);"> 7</span>      <span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">*/</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);"> 8</span>     <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">private</span> <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> max<span style="line-height: 1.5 !important; background-color: rgb(173, 216, 230);">Rectangle</span>(<span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">char</span>[][] matrix, <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> row, <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span><span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> col) {
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);"> 9</span>         <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> minWidth =<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> Integer.MAX_VALUE;
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">10</span>         <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> maxArea = 0<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">;
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">11</span>         <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">for</span> (<span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> i = row; i &lt; matrix.length &amp;&amp; matrix[i][col] == '1'; i++<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">) {
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">12</span>             <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> width = 0<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">;
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">13</span>             <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">while</span> (col + width &lt;<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> matrix[row].length
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">14</span>                     &amp;&amp; matrix[i][col + width] == '1'<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">) {
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">15</span>                 width++<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">;
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">16</span> <span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">            }
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">17</span>             <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">if</span> (width &lt; minWidth) {<span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">//</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 0);"> 如果当前宽度小于了以前的最小宽度，更新它，为下面的矩形计算做准备</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">18</span>                 minWidth =<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> width;
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">19</span> <span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">            }
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">20</span>             <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> area = minWidth * (i - row + 1<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">);
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">21</span>             <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">if</span> (area &gt;<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> maxArea)
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">22</span>                 maxArea =<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> area;
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">23</span> <span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">        }
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">24</span>         <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">return</span><span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> maxArea;
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">25</span>     }
</pre><div style="margin-top: 5px;"><span style="line-height: 1.5 !important; padding-right: 5px;"><a style="color: rgb(26, 139, 200); border: none !important;" title="复制代码"><img src="Maximal Rectangle_files/Image [2].gif" type="image/gif" alt="复制代码" style="cursor: default;"/></a></span></div></div></div><p style="margin: 10px auto !important;">这样，我们再对每个点都调用一下上面的这个方法，不是就能求出最大面积了么。</p><p style="margin: 10px auto !important;"><strong>解法一：</strong></p><div style="background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; font-family: 'Courier New' !important; font-size: 12px !important;"><img src="Maximal Rectangle_files/Image [3].gif" type="image/gif" style="cursor: default;"/><div><div style="margin-top: 5px;"><span style="line-height: 1.5 !important; padding-right: 5px;"><a style="color: rgb(26, 139, 200); border: none !important;" title="复制代码"><img src="Maximal Rectangle_files/Image [4].gif" type="image/gif" alt="复制代码" style="cursor: default;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">public</span> <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> <span style="line-height: 1.5 !important; background-color: rgb(173, 216, 230);">maximal</span><span style="line-height: 1.5 !important; background-color: rgb(173, 216, 230);">Rectangle</span>(<span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">char</span><span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">[][] matrix) {
        </span><span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">//</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 0);"> Start typing your Java solution below
        </span><span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">//</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 0);"> DO NOT write main() function</span>
        <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> m =<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> matrix.length;
        </span><span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> n = m == 0 ? 0 : matrix[0<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">].length;
        </span><span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> maxArea = 0<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">;
        </span><span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">for</span>(<span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> i = 0; i &lt; m; i++){<span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">//</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">row</span>
            <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">for</span>(<span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> j = 0; j &lt; n; j++){<span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">//</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">col</span>
                <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">if</span>(matrix[i][j] == '1'<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">){
                    </span><span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> area =<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> max<span style="line-height: 1.5 !important; background-color: rgb(173, 216, 230);">Rectangle</span>(matrix, i, j);
                    </span><span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">if</span>(area &gt; maxArea) maxArea =<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> area;
                }
            }
        }
        </span><span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">return</span><span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> maxArea;
     }</span></pre><div style="margin-top: 5px;"><span style="line-height: 1.5 !important; padding-right: 5px;"><a style="color: rgb(26, 139, 200); border: none !important;" title="复制代码"><img src="Maximal Rectangle_files/Image [5].gif" type="image/gif" alt="复制代码" style="cursor: default;"/></a></span></div></div></div><p style="margin: 10px auto !important;">这个需要O(n<sup>3</sup>)，所以没有通过大集合的测试。</p><p style="margin: 10px auto !important;">leetcode的讨论组给出了一个比较难理解的<a href="http://discuss.leetcode.com/questions/260/maximal-rectangle" style="color: rgb(26, 139, 200); text-decoration: none;">方法</a>，这里就不采用了。</p><p style="margin: 10px auto !important;">说说第三个方法。<a href="http://www.cnblogs.com/lichen782/p/leetcode_Largest_Rectangle_in_Histogram.html" style="color: rgb(26, 139, 200); text-decoration: none;">前一个笔记</a>，我们讨论了柱状图的最大矩形面积，那可以O(n)的，<strong><span style="line-height: 24px; font-size: 16px;">学以致用</span></strong>呀！btw，leetcode的这两题也是挨一块儿的，用心良苦。。。。</p><p style="margin: 10px auto !important;"><img src="Maximal Rectangle_files/Image [2].png" type="image/png" height="244" style="cursor: default;" width="406"/></p><p style="margin: 10px auto !important;">如果我们把每一行看成x坐标，那高度就是从那一行开始往上数的1的个数。带入我们的maxAreaInHist方法，在O(n<sup>2</sup>)时间内就可以求出每一行形成的“柱状图”的最大矩形面积了。它们之中最大的，就是我们要的答案。</p><p style="margin: 10px auto !important;">代码如下：</p><div style="background-color: rgb(245, 245, 245); border: 1px solid rgb(204, 204, 204); padding: 5px; overflow: auto; margin: 5px 0px; font-family: 'Courier New' !important; font-size: 12px !important;"><img src="Maximal Rectangle_files/Image [6].gif" type="image/gif" style="cursor: default;"/><div><div style="margin-top: 5px;"><span style="line-height: 1.5 !important; padding-right: 5px;"><a style="color: rgb(26, 139, 200); border: none !important;" title="复制代码"><img src="Maximal Rectangle_files/Image [7].gif" type="image/gif" alt="复制代码" style="cursor: default;"/></a></span></div><pre style="margin-top: 0px; margin-bottom: 0px; white-space: pre-wrap; word-wrap: break-word; font-family: 'Courier New' !important;"><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);"> 1</span> <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">public</span> <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> <span style="line-height: 1.5 !important; background-color: rgb(173, 216, 230);">maximal</span><span style="line-height: 1.5 !important; background-color: rgb(173, 216, 230);">Rectangle</span>2(<span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">char</span><span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">[][] matrix) {
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);"> 2</span>         <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> m =<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> matrix.length;
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);"> 3</span>         <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> n = m == 0 ? 0 : matrix[0<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">].length;
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);"> 4</span>         <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span>[][] height = <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">new</span> <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span>[m][n + 1<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">];
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);"> 5</span>         <span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">//</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">actually we know that height can just be a int[n+1], 
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);"> 6</span>         <span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">//</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">however, in that case, we have to write the 2 parts together in row traverse,
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);"> 7</span>         <span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">//</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">which, leetcode just doesn't make you pass big set
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);"> 8</span>         <span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">//</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 0);">所以啊，leetcode是喜欢分开写循环的，即使时间复杂度一样，即使可以节约空间</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);"> 9</span>         <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> maxArea = 0<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">;
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">10</span>         <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">for</span>(<span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> i = 0; i &lt; m; i++<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">){
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">11</span>             <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">for</span>(<span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> j = 0; j &lt; n; j++<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">) {
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">12</span>                 <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">if</span>(matrix[i][j] == '0'<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">){
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">13</span>                     height[i][j] = 0<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">;
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">14</span>                 }<span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">else</span><span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> {
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">15</span>                     height[i][j] = i == 0 ? 1 : height[i - 1][j] + 1<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">;
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">16</span> <span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">                }
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">17</span> <span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">            }
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">18</span> <span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">        }
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">19</span>         <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">for</span>(<span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> i = 0; i &lt; m; i++<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">){
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">20</span>             <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> area =<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> maxAreaInHist(height[i]);
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">21</span>             <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">if</span>(area &gt;<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> maxArea){
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">22</span>                 maxArea =<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> area;
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">23</span> <span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">            }
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">24</span> <span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">        }
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">25</span>         <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">return</span><span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> maxArea;
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">26</span> <span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">     }
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">27</span>      
<span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">28</span>      <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">private</span> <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> maxAreaInHist(<span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span><span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">[] height){
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">29</span>          Stack&lt;Integer&gt; stack = <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">new</span> Stack&lt;Integer&gt;<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">();
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">30</span>          <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> i = 0<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">;
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">31</span>          <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> maxArea = 0<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">;
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">32</span>          <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">while</span>(i &lt;<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> height.length){
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">33</span>              <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">if</span>(stack.isEmpty() || height[stack.peek()] &lt;=<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> height[i]){
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">34</span>                  stack.push(i++<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">);
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">35</span>              }<span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">else</span><span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> {
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">36</span>                  <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">int</span> t =<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> stack.pop();
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">37</span>                  maxArea = Math.max(maxArea, height[t] * (stack.isEmpty() ? i : i - stack.peek() - 1<span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">));
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">38</span> <span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">             }
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">39</span> <span style="line-height: 1.5 !important; color: rgb(0, 0, 0);">         }
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">40</span>          <span style="line-height: 1.5 !important; color: rgb(0, 0, 255);">return</span><span style="line-height: 1.5 !important; color: rgb(0, 0, 0);"> maxArea;
</span><span style="line-height: 1.5 !important; color: rgb(0, 128, 128);">41</span>      }
</pre><div style="margin-top: 5px;"><span style="line-height: 1.5 !important; padding-right: 5px;"><a style="color: rgb(26, 139, 200); border: none !important;" title="复制代码"><img src="Maximal Rectangle_files/Image [8].gif" type="image/gif" alt="复制代码" style="cursor: default;"/></a></span></div></div></div><p style="margin: 10px auto !important;">这里有一个和leetcode相关的细节。就是本来在计算height数组的时候，我们没有必要分配成代码中的那个样子，一维就可以了，然后在遍历每一行的时候计算当前行的height数组，然后再计算maxArea。这种情况下还是过不了大集合，所以不得不为每一行都保存一个height，先期计算该二维数组。</p><p style="margin: 10px auto !important;">总结：</p><p style="margin: 10px auto !important;">1. 学到的新知识要用；</p><p style="margin: 10px auto !important;">2. 画面感和逻辑分析都很重要，不可偏非。</p></div></div></div>
</div></body></html> 